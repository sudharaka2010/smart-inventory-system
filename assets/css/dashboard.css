/* ================= RB Stores — Dashboard (no-page-scroll, responsive) ================
   Scope: <main id="rb-main" data-rb-scope="main" data-page="dashboard">
   ----------------------------------------------------------------------------------- */

/* -------- Desktop rail reserve: avoids crossing under sidebar (≥1200px) -------- */
@media (min-width:1200px){
  /* Change to your real sidebar width if needed */
  body:has(#rb-main[data-page="dashboard"]){ --rb-rail-w: 320px; }
  body:has(#rb-main[data-page="dashboard"]) #rbShell{ padding-left: var(--rb-rail-w); }
  body:has(#rb-main[data-page="dashboard"]) [data-rb-scope="sidebar"]{ width: var(--rb-rail-w) !important; }
}

/* -------- Make dashboard occupy the viewport, disable page scroll here -------- */
body:has(#rb-main[data-page="dashboard"]){ overflow: hidden; }  /* no page scroll on dashboard */

#rb-main[data-page="dashboard"]{
  /* Layout tokens */
  --d-header: 68px;                  /* your sticky header height */
  --db-max: 1280px;
  --db-pad: clamp(12px, 2vw, 24px);
  --db-gap: clamp(10px, 1.6vw, 18px);

  /* Theme */
  --db-surface:   #0f1b2f;
  --db-surface-2: #12223b;
  --db-text:      #e8eef7;
  --db-text-2:    #a9bed6;
  --db-text-3:    #86a0ba;
  --db-border:    #213553;
  --db-accent:    #3b82f6;
  --db-accent-2:  #60a5fa;
  --db-radius: 14px;
  --db-shadow: 0 12px 30px rgba(0,0,0,.25);

  /* Full-height stage (no page scroll) */
  height: calc(100svh - var(--d-header));
  max-width: var(--db-max);
  margin-inline: auto;
  padding: 0 var(--db-pad) 12px;
  overflow: hidden;                   /* contain internal scrolling */
  color: var(--db-text);
  display: flex; flex-direction: column;

  /* Soft top fade */
  background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,0)) 0 0/100% 108px no-repeat;
}

/* ---------- Top blocks (title/alerts/actions) just take natural space ---------- */
#rb-main[data-page="dashboard"] .hero h1{ letter-spacing:.2px; color:var(--db-text); }
#rb-main[data-page="dashboard"] .hero .text-secondary{ color:var(--db-text-2)!important; }
#rb-main[data-page="dashboard"] .btn-action{ min-width:192px; }
@media (max-width:575.98px){ #rb-main[data-page="dashboard"] .btn-action{ min-width:100%; } }

/* ---------- KPI section: natural height, tidy spacing ---------- */
#rb-main[data-page="dashboard"] .kpi{ row-gap: var(--db-gap)!important; }
#rb-main[data-page="dashboard"] .kpi .card{
  min-height: 144px;
  display:flex; align-items:center;
}
#rb-main[data-page="dashboard"] .kpi .icon{
  width:48px; height:48px; display:grid; place-items:center;
  background: color-mix(in srgb, var(--db-accent) 12%, transparent);
  color:var(--db-accent-2); border-radius:12px; font-size:1.15rem;
}
#rb-main[data-page="dashboard"] .kpi .fs-4{ font-size: clamp(1.25rem, 1.05rem + 0.7vw, 1.8rem); }

/* ---------- TABLES section: fills the remaining viewport height ---------- */
#rb-main[data-page="dashboard"] > section:last-of-type{
  /* This is the “Tables” row in your markup */
  flex: 1 1 auto;            /* take all remaining height */
  min-height: 0;             /* allow children to shrink */
  overflow: hidden;          /* no outer scroll */
  display: block;
}

/* Left column (Recent Orders) should stretch full height */
#rb-main[data-page="dashboard"] > section:last-of-type .col-xl-7{
  height: 100%;
  display: flex; flex-direction: column;
}

/* Right column (Top Items + Low Stock) split the height */
#rb-main[data-page="dashboard"] > section:last-of-type .col-xl-5{
  height: 100%;
  display: flex; flex-direction: column;
  gap: var(--db-gap);
}
#rb-main[data-page="dashboard"] > section:last-of-type .col-xl-5 > .card{
  flex: 1 1 0;               /* two cards share column height */
  min-height: 0;
}

/* Cards as flexible containers so their table area can scroll internally */
#rb-main[data-page="dashboard"] .card{
  background: linear-gradient(180deg, color-mix(in srgb, var(--db-surface) 92%, #fff 8%) 0%, var(--db-surface) 100%);
  border:1px solid var(--db-border); color:var(--db-text);
  border-radius:var(--db-radius); box-shadow:var(--db-shadow);
  display: flex; flex-direction: column; min-height: 0;
}
#rb-main[data-page="dashboard"] .card-header,
#rb-main[data-page="dashboard"] .card-footer{
  background:transparent; border-color: color-mix(in srgb, var(--db-border) 80%, transparent);
}
#rb-main[data-page="dashboard"] .card .text-secondary{ color:var(--db-text-2)!important; }
#rb-main[data-page="dashboard"] .card.shadow-sm{ transition:transform .12s, box-shadow .12s; }
#rb-main[data-page="dashboard"] .card.shadow-sm:hover{ transform:translateY(-2px); box-shadow:0 18px 36px rgba(0,0,0,.28); }

/* Make the table area consume the free space INSIDE a card */
#rb-main[data-page="dashboard"] .card-body{ flex: 1 1 auto; min-height: 0; display:block; }
#rb-main[data-page="dashboard"] .card-body > .table-responsive{
  height: 100%; min-height: 0; overflow: auto;
  -webkit-overflow-scrolling: touch;
}

/* On stacked layouts (<1200px), give sensible heights in viewport units */
@media (max-width:1199.98px){
  #rb-main[data-page="dashboard"] .recent-orders .table-responsive{ height: clamp(38svh, 44svh, 48svh); }
  #rb-main[data-page="dashboard"] .top-items     .table-responsive{ height: clamp(20svh, 24svh, 28svh); }
  #rb-main[data-page="dashboard"] .low-stock     .table-responsive{ height: clamp(20svh, 24svh, 28svh); }
}

/* ---------- Forms / Inputs in headers ---------- */
#rb-main[data-page="dashboard"] .card-header .form-control,
#rb-main[data-page="dashboard"] .card-header .form-select{
  background: var(--db-surface-2);
  color: var(--db-text);
  border-color: var(--db-border);
  border-radius: calc(var(--db-radius) - 6px);
}
#rb-main[data-page="dashboard"] .card-header .form-control::placeholder{ color: var(--db-text-3); }
#rb-main[data-page="dashboard"] .card-header .form-control:focus,
#rb-main[data-page="dashboard"] .card-header .form-select:focus{
  border-color: color-mix(in srgb, var(--db-accent) 70%, #fff 30%);
  box-shadow: 0 0 0 .2rem color-mix(in srgb, var(--db-accent) 18%, transparent);
}

/* ---------- Buttons (theme-matched) ---------- */
#rb-main[data-page="dashboard"] .btn-primary{
  --bs-btn-bg: linear-gradient(180deg, color-mix(in srgb, var(--db-accent-2) 85%, #000 15%), var(--db-accent));
  --bs-btn-border-color: color-mix(in srgb, var(--db-accent) 85%, #000 15%);
  --bs-btn-hover-bg: color-mix(in srgb, var(--db-accent) 82%, #000 18%);
  --bs-btn-hover-border-color: color-mix(in srgb, var(--db-accent) 82%, #000 18%);
  border-radius:12px;
}
#rb-main[data-page="dashboard"] .btn-outline-primary{
  --bs-btn-color: var(--db-accent-2);
  --bs-btn-border-color: var(--db-accent-2);
  --bs-btn-hover-bg: var(--db-accent-2);
  --bs-btn-hover-border-color: var(--db-accent-2);
  border-radius:12px;
}
#rb-main[data-page="dashboard"] .btn-outline-light{
  --bs-btn-color:#cfe0f7; --bs-btn-border-color: var(--db-border);
  --bs-btn-hover-bg:#162a49; --bs-btn-hover-border-color:#274067;
  border-radius:12px;
}

/* ---------- Tables (clean, fixed widths, internal scroll) ---------- */
#rb-main[data-page="dashboard"] .table{
  color: var(--db-text);
  border-color: var(--db-border);
  table-layout: fixed;                       /* stable column widths */
}
#rb-main[data-page="dashboard"] .table thead.table-light th{
  background: linear-gradient(180deg, #172a48, #13243e) !important;
  color: var(--db-text);
  border-bottom-color: var(--db-border);
  position: sticky; top: 0; z-index: 1;
}
#rb-main[data-page="dashboard"] .table-striped>tbody>tr:nth-of-type(odd){
  --bs-table-accent-bg: rgba(255,255,255,.03);
}
#rb-main[data-page="dashboard"] .table-hover>tbody>tr:hover{ background: rgba(96,165,250,.10); }
#rb-main[data-page="dashboard"] .table td, 
#rb-main[data-page="dashboard"] .table th{
  border-color: var(--db-border);
  vertical-align: middle;
  padding-block: .68rem;
  font-size: .98rem;
}
#rb-main[data-page="dashboard"] .text-end{ font-variant-numeric: tabular-nums; }

/* Helpful fixed columns (prevents jitter) */
#rb-main[data-page="dashboard"] table.recent-orders thead th:nth-child(1),
#rb-main[data-page="dashboard"] table.recent-orders tbody td:nth-child(1){ width: 92px; }
#rb-main[data-page="dashboard"] table.recent-orders thead th:nth-child(2),
#rb-main[data-page="dashboard"] table.recent-orders tbody td:nth-child(2){ width: 170px; }
#rb-main[data-page="dashboard"] table.recent-orders thead th:nth-child(4),
#rb-main[data-page="dashboard"] table.recent-orders tbody td:nth-child(4){ width: 120px; }
#rb-main[data-page="dashboard"] table.recent-orders thead th:nth-child(5),
#rb-main[data-page="dashboard"] table.recent-orders tbody td:nth-child(5){ width: 140px; }
#rb-main[data-page="dashboard"] table.recent-orders thead th:nth-child(6),
#rb-main[data-page="dashboard"] table.recent-orders tbody td:nth-child(6){ width: 120px; }

#rb-main[data-page="dashboard"] table.top-items thead th:nth-child(2),
#rb-main[data-page="dashboard"] table.top-items tbody td:nth-child(2){ width: 120px; }
#rb-main[data-page="dashboard"] table.low-stock thead th:nth-child(2),
#rb-main[data-page="dashboard"] table.low-stock tbody td:nth-child(2){ width: 90px; }
#rb-main[data-page="dashboard"] table.low-stock thead th:nth-child(3),
#rb-main[data-page="dashboard"] table.low-stock tbody td:nth-child(3){ width: 160px; }

/* Truncate long names gracefully */
#rb-main[data-page="dashboard"] table .text-truncate,
#rb-main[data-page="dashboard"] table td:first-child{
  overflow: hidden; text-overflow: ellipsis; white-space: nowrap;
}

/* ---------- Small-screen padding & density ---------- */
@media (max-width:767.98px){
  #rb-main[data-page="dashboard"] .card-body{ padding: .9rem 1rem; }
  #rb-main[data-page="dashboard"] .card-header,
  #rb-main[data-page="dashboard"] .card-footer{ padding: .75rem 1rem; }
}

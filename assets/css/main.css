@layer main {
  /* ---------- Scope root ---------- */
  [data-rb-scope="main"]{
    /* Layout */
    min-height: calc(100dvh - var(--rb-header-h) - var(--rb-footer-h));
    padding: var(--rb-space-4);
    overflow-x: hidden;

    /* Look & feel */
    color: var(--rb-text);
    background:
      linear-gradient(180deg, color-mix(in oklab, var(--rb-bg) 96%, #000 4%), var(--rb-bg));
    font-family: var(--rb-font-sans);
    font-size: var(--rb-fs-16);
    line-height: 1.6;
  }

  /* ---------- Box model safety INSIDE main ---------- */
  [data-rb-scope="main"], 
  [data-rb-scope="main"] * { box-sizing: border-box; }

  /* Images & media safe sizing */
  [data-rb-scope="main"] img,
  [data-rb-scope="main"] video,
  [data-rb-scope="main"] canvas { max-width: 100%; height: auto; display: block; }

  /* ---------- Container & grid helpers (main only) ---------- */
  [data-rb-scope="main"] .container{
    width: min(1200px, 100%);
    margin-inline: auto;
    padding-inline: var(--rb-space-4);
  }

  [data-rb-scope="main"] .grid{
    display: grid;
    gap: var(--rb-space-4);
  }

  /* 12-col responsive grid */
  [data-rb-scope="main"] .grid-12{
    grid-template-columns: repeat(12, 1fr);
  }
  @media (max-width: 1199px){
    [data-rb-scope="main"] .grid-12{ grid-template-columns: repeat(8, 1fr); }
  }
  @media (max-width: 767px){
    [data-rb-scope="main"] .grid-12{ grid-template-columns: repeat(4, 1fr); }
  }

  /* Column span utility: .col-span-3 etc. */
  [data-rb-scope="main"] [class*="col-span-"]{ grid-column: span 12; }
  [data-rb-scope="main"] .col-span-1{ grid-column: span 1; }
  [data-rb-scope="main"] .col-span-2{ grid-column: span 2; }
  [data-rb-scope="main"] .col-span-3{ grid-column: span 3; }
  [data-rb-scope="main"] .col-span-4{ grid-column: span 4; }
  [data-rb-scope="main"] .col-span-6{ grid-column: span 6; }
  [data-rb-scope="main"] .col-span-8{ grid-column: span 8; }
  [data-rb-scope="main"] .col-span-12{ grid-column: span 12; }

  /* ---------- Card & surface patterns (main only) ---------- */
  [data-rb-scope="main"] .card{
    background: var(--rb-card);
    border: 1px solid var(--rb-border);
    border-radius: var(--rb-radius);
    box-shadow: var(--rb-shadow);
    padding: var(--rb-space-4);
  }
  [data-rb-scope="main"] .card.soft{
    background: var(--rb-bg-soft);
  }

  /* ---------- Headings & text ---------- */
  [data-rb-scope="main"] h1{ font-size: clamp(24px, 2.2vw, 32px); margin: 0 0 var(--rb-space-4); }
  [data-rb-scope="main"] h2{ font-size: clamp(20px, 1.8vw, 28px); margin: 0 0 var(--rb-space-3); }
  [data-rb-scope="main"] h3{ font-size: clamp(18px, 1.6vw, 24px); margin: 0 0 var(--rb-space-2); }
  [data-rb-scope="main"] p { margin: 0 0 var(--rb-space-3); color: var(--rb-text); }
  [data-rb-scope="main"] .muted{ color: var(--rb-text-dim); }

  /* ---------- Buttons (neutral pattern) ---------- */
  [data-rb-scope="main"] .btn{
    display: inline-flex; align-items: center; justify-content: center;
    gap: 8px; height: 38px; padding: 0 14px;
    border-radius: 10px; border: 1px solid var(--rb-border);
    background: linear-gradient(180deg, color-mix(in oklab, var(--rb-bg-soft) 90%, #fff 10%), var(--rb-bg-soft));
    color: var(--rb-text);
    transition: transform var(--rb-speed-fast) var(--rb-ease), border-color var(--rb-speed) var(--rb-ease), box-shadow var(--rb-speed) var(--rb-ease);
    text-decoration: none; cursor: pointer;
  }
  [data-rb-scope="main"] .btn:hover{ transform: translateY(-1px); border-color: color-mix(in oklab, var(--rb-border), var(--rb-primary-600)); }
  [data-rb-scope="main"] .btn.primary{
    background: linear-gradient(180deg, var(--rb-primary-600), var(--rb-primary-700));
    border-color: transparent; color: #fff;
  }
  [data-rb-scope="main"] .btn:focus-visible{
    outline: 2px solid color-mix(in oklab, var(--rb-primary-600), white 25%);
    outline-offset: 2px;
  }

  /* ---------- Forms (main only) ---------- */
  [data-rb-scope="main"] .field{
    display: grid; gap: 6px; margin-bottom: var(--rb-space-4);
  }
  [data-rb-scope="main"] label{ font-size: var(--rb-fs-14); color: var(--rb-text-dim); }
  [data-rb-scope="main"] input[type="text"],
  [data-rb-scope="main"] input[type="number"],
  [data-rb-scope="main"] input[type="date"],
  [data-rb-scope="main"] select,
  [data-rb-scope="main"] textarea{
    width: 100%;
    background: var(--rb-bg-soft);
    color: var(--rb-text);
    border: 1px solid var(--rb-border);
    border-radius: 10px;
    padding: 10px 12px;
    transition: border-color var(--rb-speed) var(--rb-ease), box-shadow var(--rb-speed) var(--rb-ease);
  }
  [data-rb-scope="main"] input:focus,
  [data-rb-scope="main"] select:focus,
  [data-rb-scope="main"] textarea:focus{
    border-color: color-mix(in oklab, var(--rb-border), var(--rb-primary-600));
    box-shadow: 0 0 0 3px color-mix(in oklab, var(--rb-primary-600), transparent 70%);
    outline: none;
  }

  /* ---------- Tables (main only) ---------- */
  [data-rb-scope="main"] .table-wrap{ width:100%; overflow:auto; border-radius: var(--rb-radius); }
  [data-rb-scope="main"] table{
    width: 100%;
    border-collapse: collapse;
    background: var(--rb-card);
    color: var(--rb-text);
  }
  [data-rb-scope="main"] thead th{
    position: sticky; top: 0; z-index: var(--rb-z-main);
    background: var(--rb-bg-soft);
    text-align: left; font-weight: 600; padding: 10px 12px;
    border-bottom: 1px solid var(--rb-border);
  }
  [data-rb-scope="main"] tbody td{
    padding: 10px 12px; border-bottom: 1px solid var(--rb-border);
  }
  [data-rb-scope="main"] tbody tr:nth-child(odd){ background: var(--rb-table-stripe); }

  /* ---------- Utilities (main only) ---------- */
  [data-rb-scope="main"] .stack{ display:flex; flex-direction:column; gap: var(--rb-space-4); }
  [data-rb-scope="main"] .row{ display:flex; flex-wrap: wrap; gap: var(--rb-space-3); }
  [data-rb-scope="main"] .hidden{ display:none !important; }
  [data-rb-scope="main"] .nowrap{ white-space: nowrap; }
  [data-rb-scope="main"] .right{ margin-left:auto; }

  /* ---------- Page gate (optional) ---------- */
  /* Example: apply styles only on a specific page */
  /* [data-rb-scope="main"][data-page="dashboard"] { --dash-gap: var(--rb-space-4); } */

  /* ---------- Print (main content) ---------- */
  @media print {
    [data-rb-scope="main"]{
      background: #fff !important; color: #000 !important;
      padding: 0; min-height: auto;
    }
    [data-rb-scope="main"] .card{ box-shadow: none; border-color: #bbb; }
    [data-rb-scope="main"] .btn{ display: none !important; }
  }
}

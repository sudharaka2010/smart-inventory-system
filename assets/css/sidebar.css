/* ===================== RB Stores â€” Sidebar (STRICTLY SCOPED) =====================
   Scope guard: ONLY target inside [data-rb-scope="sidebar"] and #rbSidebar
   - Safe for Bootstrap 5.3.x
   - No global element selectors, no body/main/header/footer changes
   - Offcanvas on mobile, sticky rail on desktop (xl+)
================================================================================== */

/* ---------- Theme tokens (scoped) ---------- */
[data-rb-scope="sidebar"]{
  --rb-sb-w: 280px;                 /* rail width on xl+ */
  --rb-sb-bg:#0f172a;               /* slate-900 */
  --rb-sb-bg-soft:#0b1222;          /* deeper */
  --rb-sb-text:#e5e7eb;             /* gray-200 */
  --rb-sb-text-dim:#9fb9e8;         /* soft blue-gray */
  --rb-sb-border:rgba(148,208,236,.28);
  --rb-sb-accent:#6375ff;           /* brand mid */
  --rb-sb-accent-2:#3b82f6;         /* blue */
  --rb-sb-hover:rgba(255,255,255,.06);
  --rb-sb-active:rgba(99,117,255,.16);
  --rb-sb-shadow:0 12px 30px rgba(0,0,0,.35);
  --rb-sb-radius:14px;
  --rb-sb-focus:0 0 0 3px rgba(99,117,255,.35);
  --rb-sb-divider:linear-gradient(90deg,transparent,rgba(148,208,236,.25),transparent);
}

/* ---------- Mobile Top Bar (shows only < xl) ---------- */
[data-rb-scope="sidebar"] .rb-sb-topbar{
  position: sticky; top: 0; z-index: 1030;
  display: flex; align-items: center;
  height: 56px;
  padding: 0 .75rem;
  background: linear-gradient(180deg,var(--rb-sb-bg),var(--rb-sb-bg-soft));
  color: var(--rb-sb-text);
  border-bottom: 1px solid var(--rb-sb-border);
  box-shadow: 0 6px 16px rgba(0,0,0,.2);
}
[data-rb-scope="sidebar"] .rb-sb-topbar-btn{
  display: inline-flex; align-items: center; justify-content: center;
  width: 44px; height: 44px; border-radius: 12px;
  color: var(--rb-sb-text);
  background: transparent;
  border: 1px solid transparent;
}
[data-rb-scope="sidebar"] .rb-sb-topbar-btn:hover{ background: var(--rb-sb-hover); }
[data-rb-scope="sidebar"] .rb-sb-topbar-btn:focus-visible{ outline: none; box-shadow: var(--rb-sb-focus); }

/* ---------- Offcanvas shell (mobile behavior) ---------- */
#rbSidebar.offcanvas{
  background: var(--rb-sb-bg);
  color: var(--rb-sb-text);
  border-right: 1px solid var(--rb-sb-border);
}
#rbSidebar.offcanvas .offcanvas-header{
  border-bottom: 1px solid var(--rb-sb-border);
  background: var(--rb-sb-bg-soft);
  color: var(--rb-sb-text);
}
#rbSidebar.offcanvas .offcanvas-title{ font-weight: 600; }

/* ---------- Sidebar body/nav ---------- */
#rbSidebar .offcanvas-body{
  display: flex; flex-direction: column;
  gap: .25rem;
  padding: 0 !important;
  background: var(--rb-sb-bg);
}

#rbSidebar .rb-sb-brand{
  color: var(--rb-sb-text);
  border-bottom: 1px solid var(--rb-sb-border);
  background: linear-gradient(180deg,var(--rb-sb-bg-soft),var(--rb-sb-bg));
}
#rbSidebar .rb-sb-brand .rb-sb-brand-text{
  font-weight: 700; letter-spacing: .2px;
}

/* ---------- Accordion (menus) ---------- */
#rbSidebar .accordion{
  --bs-accordion-bg: transparent;
  --bs-accordion-color: var(--rb-sb-text);
  --bs-accordion-border-color: transparent;
  --bs-accordion-btn-padding-x: 1rem;
  --bs-accordion-btn-padding-y: .875rem;
  --bs-accordion-active-color: var(--rb-sb-text);
  --bs-accordion-btn-focus-box-shadow: 0 0 0 0 transparent; /* we'll handle focus */
}

#rbSidebar .rb-sb-acc-item{
  border: 0;
  border-bottom: 1px solid rgba(255,255,255,.03);
}

#rbSidebar .rb-sb-acc-btn{
  gap: .5rem;
  color: var(--rb-sb-text);
  background: transparent;
  border-radius: 0;
}
#rbSidebar .rb-sb-acc-btn.collapsed{
  background: transparent;
}
#rbSidebar .rb-sb-acc-btn:hover{
  background: var(--rb-sb-hover);
}
#rbSidebar .rb-sb-acc-btn:focus-visible{
  outline: none; box-shadow: var(--rb-sb-focus);
}

#rbSidebar .accordion-collapse{
  background: rgba(255,255,255,.01);
  transition: height .2s ease, transform .2s ease;
}

/* ---------- Link list inside sections ---------- */
#rbSidebar .rb-sb-menu{
  margin: 0; padding: .375rem 0;
  display: grid; gap: 2px;
}
#rbSidebar .rb-sb-link{
  display: flex; align-items: center;
  padding: .625rem 1rem;
  gap: .5rem;
  color: var(--rb-sb-text);
  text-decoration: none;
  border-left: 2px solid transparent;
}
#rbSidebar .rb-sb-link .bi{ font-size: 1rem; opacity: .9; }

#rbSidebar .rb-sb-link:hover{
  background: var(--rb-sb-hover);
  color: var(--rb-sb-text);
}
#rbSidebar .rb-sb-link:focus-visible{
  outline: none; box-shadow: inset var(--rb-sb-focus);
  border-radius: 8px;
}

#rbSidebar .rb-sb-link.active{
  background: var(--rb-sb-active);
  border-left-color: var(--rb-sb-accent);
  color: #fff;
}

/* Divider line utility (if needed) */
#rbSidebar .rb-sb-divider{
  height: 1px; margin: .25rem 0;
  background: var(--rb-sb-divider);
}

/* ---------- Footer area ---------- */
#rbSidebar .rb-sb-footer{
  border-top: 1px solid var(--rb-sb-border);
  background: linear-gradient(0deg,var(--rb-sb-bg-soft),transparent);
}
#rbSidebar .rb-sb-footer .rb-sb-link{
  border-left-color: transparent !important;
  border-radius: 10px;
}
#rbSidebar .rb-sb-footer .rb-sb-link:hover{ background: var(--rb-sb-hover); }

/* ---------- Desktop rail mode (xl and up) ---------- */
@media (min-width: 1200px){
  /* Turn the offcanvas into a static, sticky rail */
  #rbSidebar.offcanvas{
    position: sticky;
    top: 0;
    transform: none !important;
    visibility: visible !important;
    transition: none !important;
    box-shadow: var(--rb-sb-shadow);
    width: var(--rb-sb-w);
    max-width: var(--rb-sb-w);
    min-height: 100dvh;
    border-right: 1px solid var(--rb-sb-border);
    border-radius: 0;
  }
  /* Hide the offcanvas close header on desktop */
  #rbSidebar .offcanvas-header{ display: none !important; }
  /* Ensure body area inside is scrollable but header/footer stick */
  #rbSidebar .offcanvas-body{
    height: 100%;
    overflow: auto;
  }
  /* Hide the mobile top bar on desktop (Bootstrap d-xl-none already used in HTML) */
  [data-rb-scope="sidebar"] .rb-sb-topbar{ display: none !important; }
}

/* ---------- Reduced motion ---------- */
@media (prefers-reduced-motion: reduce){
  #rbSidebar .accordion-collapse{ transition: none; }
}

/* ---------- High-contrast tweaks ---------- */
@media (forced-colors: active){
  [data-rb-scope="sidebar"]{
    --rb-sb-border: CanvasText;
  }
  #rbSidebar .rb-sb-link.active{
    outline: 2px solid Highlight; border-left-color: Highlight;
  }
}
